diff -rupN bwa-0.7.9a/bwamem.c bwa-0.7.9a-patched/bwamem.c
--- bwa-0.7.9a/bwamem.c	2014-05-19 09:11:41.000000000 -0400
+++ bwa-0.7.9a-patched/bwamem.c	2014-07-07 23:57:26.000000000 -0400
@@ -920,6 +920,8 @@ void mem_aln2sam(const bntseq_t *bns, ks
 		}
 	}
 	if (p->XA) { kputsn("\tXA:Z:", 6, str); kputs(p->XA, str); }
+	if (p->pair_score > 0) { kputsn("\tZP:i:", 6, str); kputw(p->pair_score, str); }
+	if (p->pair_sub > 0) { kputsn("\tZp:i:", 6, str); kputw(p->pair_sub, str); }
 	if (s->comment) { kputc('\t', str); kputs(s->comment, str); }
 	kputc('\n', str);
 }
diff -rupN bwa-0.7.9a/bwamem.h bwa-0.7.9a-patched/bwamem.h
--- bwa-0.7.9a/bwamem.h	2014-05-19 09:11:41.000000000 -0400
+++ bwa-0.7.9a-patched/bwamem.h	2014-07-07 23:56:06.000000000 -0400
@@ -88,6 +88,7 @@ typedef struct { // This struct is only 
 	char *XA;        // alternative mappings
 
 	int score, sub;
+	int pair_score, pair_sub;
 } mem_aln_t;
 
 #ifdef __cplusplus
diff -rupN bwa-0.7.9a/bwamem_pair.c bwa-0.7.9a-patched/bwamem_pair.c
--- bwa-0.7.9a/bwamem_pair.c	2014-05-19 16:48:23.000000000 -0400
+++ bwa-0.7.9a-patched/bwamem_pair.c	2014-07-07 23:56:38.000000000 -0400
@@ -327,6 +327,8 @@ int mem_sam_pe(const mem_opt_t *opt, con
 		// write SAM
 		h[0] = mem_reg2aln(opt, bns, pac, s[0].l_seq, s[0].seq, &a[0].a[z[0]]); h[0].mapq = q_se[0]; h[0].flag |= 0x40 | extra_flag; h[0].XA = XA[0]? XA[0][z[0]] : 0;
 		h[1] = mem_reg2aln(opt, bns, pac, s[1].l_seq, s[1].seq, &a[1].a[z[1]]); h[1].mapq = q_se[1]; h[1].flag |= 0x80 | extra_flag; h[1].XA = XA[1]? XA[1][z[1]] : 0;
+		h[0].pair_score = h[1].pair_score = a[0].a[0].score + a[1].a[0].score;
+		h[0].pair_sub = h[1].pair_sub = subo;
 		mem_aln2sam(bns, &str, &s[0], 1, &h[0], 0, &h[1], opt->flag&MEM_F_SOFTCLIP); s[0].sam = strdup(str.s); str.l = 0;
 		mem_aln2sam(bns, &str, &s[1], 1, &h[1], 0, &h[0], opt->flag&MEM_F_SOFTCLIP); s[1].sam = str.s;
 		if (strcmp(s[0].name, s[1].name) != 0) err_fatal(__func__, "paired reads have different names: \"%s\", \"%s\"\n", s[0].name, s[1].name);
